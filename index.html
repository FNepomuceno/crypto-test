<!doctype html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
<script src="key.js"></script>
<script src="store.js"></script>
<script>
(async function () {
  let {
    privateKey: aPrivate,
    publicKey: aPublic
  } = await generateEcKeypair()

  await Promise.all([
    storeKey(aPrivate),
    storeKey(aPublic)
  ])

  const exportType = 'pkcs8'
  console.log(await keyToHex(aPrivate, exportType),
    await keyToHex(await loadKey('private'), exportType))

  async function keyToHex(key, type) {
    let buffer = await window.crypto.subtle.exportKey(type, key)
    let data = Array.from(new Uint8Array(buffer))
    return data.map(x => x.toString(16).padStart(2, '0')).join('')
  }
})()
</script>
</body>
</html>
